<div class="main-content">
    <div class="page-content">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <div class="page-title-box d-sm-flex align-items-center justify-content-between">
                        <h4 class="mb-sm-0">Membresias</h4>
                        <div class="page-title-right">
                            <ol class="breadcrumb m-0">
                                <li class="breadcrumb-item">
                                    <a href="/membresias">Membresias</a>
                                </li>
                                <li class="breadcrumb-item active">Membresias</li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-lg-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="card-title mb-0">Vista de Membresias</h5>
                        </div>

                        <!-- Botón registrar -->
                        <div class="card-header d-flex justify-content-between responsive" style="border-bottom:none;">
                            <button class="btn d-flex align-items-center"
                                style="background-color:#004d97; color:#f9f9f9; border:none; font-size:14px; border-radius:30px; padding:10px 15px; margin:15px;"
                                id="btnAddMemberships">
                                Registrar Membresia
                            </button>
                        </div>

                        <!-- Tabla -->
                        <div class="card-body">
                            <div id="Cursos" class="card-datatable table-responsive" style="overflow-x:auto;">
                                <table id="membershipsTable" class="table table-bordered nowrap table-striped w-100">
                                    <thead>
                                        <tr>
                                            <th class="sticky-col col-acciones">Acciones</th>
                                            <th class="sticky-col col-estatus">Estatus</th>
                                            <th class="sticky-col col-cliente">Cliente</th>
                                            <th>Clases Adquiridas</th>
                                        </tr>
                                    </thead>
                                    <tbody id="tbTableMemberships"></tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal crear/editar curso -->
<div class="modal fade" id="modalAddMemberships" tabindex="-1" aria-modal="true">
    <div class="modal-dialog modal-xl modal-dialog-centered modal-fullscreen-sm-down">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Registrar Nueva Membresia</h5>
                <button type="button" class="btn-soft-secondary btn-close" data-bs-dismiss="modal"></button>
            </div>

            <div class="modal-body">
                <form id="membershipsForm" class="needs-validation" novalidate>
                    <div class="row g-3">
                        <div class="col-xxl-6">
                            <label for="customer" class="form-label">Seleccionar Usuario(*)</label>
                            <select class="form-control select2" name="customer" id="userId" required>
                                <option value="">Selecciona un Usuario</option>
                            </select>
                            <div class="invalid-feedback">Campo obligatorio.</div>
                        </div>
                        <div class="col-xxl-6" id="packageField">
                            <label for="acquiredClasses" class="form-label">Clases Adquiridas(*)</label>
                            <input type="number" value="" class="form-control" name="acquiredClasses" id="acquiredClasses" placeholder="Ingrese la cantidad de clases adquiridas" min="1" max="10" required>
                            <div class="invalid-feedback">Campo obligatorio.</div>
                        </div>
                    </div>

                    <div class="col-lg-12 d-flex justify-content-end">
                        <button style="background-color:#004c99; color:#fff;" type="submit" id="btnAddCursos"
                            class="btn rounded-pill">
                            Guardar
                        </button>
                    </div>
            </div>
            </form>
        </div>

    </div>
</div>
</div>

<!-- Scripts -->
<script defer src="./js/memberships.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/tinymce/6.0.0/tinymce.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/tinymce@6/langs/es.js"></script>

<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet" />

<style>
    /* ===== Variables (ajusta anchos aquí) ===== */
    :root {
        --w-acciones: 168px;
        /* caben 2 botones sin apretar */
        --w-estatus: 110px;
        /* badge Activo/Inactivo */
        --w-cliente: 260px;
        /* columna Título */
    }

    /* ===== Tabla ===== */
    #membershipsTable {
        border-collapse: collapse;
        width: 100%;
    }

    #membershipsTable th,
    #membershipsTable td {
        white-space: nowrap;
        text-align: center;
        padding: 8px 12px;
        vertical-align: middle;
        border: 1px solid #ddd;
        box-sizing: border-box;
        /* evita que los bordes rompan el cálculo de ancho */
    }

    #membershipsTable th {
        background: #f4f4f4;
        font-weight: 700;
        font-size: 16px;
    }

    /* ===== Sticky ===== */
    #membershipsTable td.sticky-col,
    #membershipsTable th.sticky-col {
        position: sticky;
        background: #fff;
        z-index: 5;
        box-shadow: 2px 0 5px rgba(0, 0, 0, .1);
        white-space: nowrap;
    }

    /* 1) Acciones */
    #membershipsTable td.col-acciones,
    #membershipsTable th.col-acciones {
        min-width: var(--w-acciones);
        width: var(--w-acciones);
        left: 0;
        z-index: 12;
    }

    /* 2) Estatus */
    #membershipsTable td.col-estatus,
    #membershipsTable th.col-estatus {
        min-width: var(--w-estatus);
        width: var(--w-estatus);
        left: calc(var(--w-acciones));
        z-index: 11;
    }

    /* 3) Título */
    #membershipsTable td.col-cliente,
    #membershipsTable th.col-cliente {
        min-width: var(--w-cliente);
        width: var(--w-cliente);
        left: calc(var(--w-acciones) + var(--w-estatus));
        z-index: 10;
    }

    /* Que los botones no se salgan */
    #membershipsTable .col-acciones .d-flex {
        gap: .5rem;
        justify-content: center;
    }

    /* ===== Responsive ===== */
    @media (max-width:768px) {

        #membershipsTable td.sticky-col,
        #membershipsTable th.sticky-col {
            position: static !important;
            left: auto !important;
            z-index: auto !important;
            box-shadow: none !important;
            background: #fff !important;
        }

        #membershipsTable th {
            font-size: 14px;
        }

        #membershipsTable td {
            font-size: 12px;
        }
    }

    /* ===== TinyMCE tweaks ===== */
    .tox-editor-container {
        width: 100% !important;
        overflow-x: auto;
    }

    .tox .tox-toolbar__primary {
        flex-wrap: nowrap !important;
        overflow-x: auto !important;
        white-space: nowrap;
        scrollbar-width: thin;
        font-size: 12px;
    }

    @media (max-width:576px) {
        .tox .tox-editor-header {
            padding: 0 4px;
        }

        .tox.tox-tinymce {
            min-height: 300px !important;
            width: 100% !important;
        }

        textarea.tiny-editor {
            resize: none !important;
        }
    }

    /* Centrado vertical de modal genérico */
    .modal-dialog-centered-custom {
        display: flex;
        align-items: center;
        min-height: 50vh;
    }

    /* Modal crear/editar curso */
    #modalAddMemberships .modal-content {
        max-height: 90vh;
        overflow-y: auto;
        padding: 20px;
    }
</style>
